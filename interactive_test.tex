\documentclass[dvipdfmx,uplatex]{jsarticle}
\usepackage{ifthen}
\usepackage{comment}
\usepackage{filecontents}
\usepackage{newfile}

\newoutputstream{mystream}

\newcounter{filenumber}
\setcounter{filenumber}{0}
\def\newinputcontent{}
\parindent=0pt

\begin{document}
\whiledo{\NOT\equal{\newinputcontent}{\par\par\par}}{%
  \openoutputfile{test\arabic{filenumber}.py}{mystream}%
  \typeout{input python code}%
  \whiledo{\NOT\equal{\newinputcontent}{\par}}{%
    \read-1 to \newinputcontent%
    \addtostream{mystream}{\newinputcontent}
  }%
  \closeoutputstream{mystream}%
  \def\newinputcontent{}
  \stepcounter{filenumber}%
  }{}%

}%
\end{document}
